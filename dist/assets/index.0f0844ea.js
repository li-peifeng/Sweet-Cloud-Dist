import{dm as D,o as S,dn as C,dp as E,k as T,P as L,x as v,dq as d,j as w,cj as R}from"./index.d735fbfd.js";function c(e,n,t,u){return e.addEventListener(n,t,u),D(e.removeEventListener.bind(e,n,t,u))}function p(e,n=E()){let t=0,u,r;return()=>(t++,S(()=>{t--,queueMicrotask(()=>{!t&&r&&(r(),r=u=void 0)})}),r||C(s=>u=e(r=s),n),u)}function g(e,n){for(let t=e.length-1;t>=0;t--){const u=n.slice(0,t+1);if(!d(e[t],u))return!1}return!0}var h=p(()=>{const[e,n]=w(null);return c(window,"keydown",t=>{n(t),setTimeout(()=>n(null))}),e}),K=p(()=>{const[e,n]=w([]),t=()=>n([]),u=h();return c(window,"keydown",r=>{if(r.repeat||typeof r.key!="string")return;const s=r.key.toUpperCase(),i=e();if(i.includes(s))return;const a=[...i,s];i.length===0&&s!=="ALT"&&s!=="CONTROL"&&s!=="META"&&s!=="SHIFT"&&(r.shiftKey&&a.unshift("SHIFT"),r.altKey&&a.unshift("ALT"),r.ctrlKey&&a.unshift("CONTROL"),r.metaKey&&a.unshift("META")),n(a)}),c(window,"keyup",r=>{if(typeof r.key!="string")return;const s=r.key.toUpperCase();n(i=>i.filter(a=>a!==s))}),c(window,"blur",t),c(window,"contextmenu",r=>{r.defaultPrevented||t()}),e[0]=e,e[1]={event:u},e[Symbol.iterator]=function*(){yield e[0],yield e[1]},e}),O=p(()=>{const e=K();let n=R(e);return v(()=>{const t=e(),u=n;return n=t,u.length===0&&t.length===1?t[0]:null})}),H=p(()=>{const e=K();return v(n=>e().length===0?[]:[...n,e()],[])});function A(e,n={}){e=e.toUpperCase();const{preventDefault:t=!0}=n,u=h(),r=O();return v(()=>{var s;return r()===e&&(t&&((s=u())==null||s.preventDefault()),!0)})}function M(e,n,t={}){if(!e.length)return;e=e.map(o=>o.toUpperCase());const{preventDefault:u=!0}=t,r=h(),s=H();let i=!1;const a=o=>{if(!o.length)return i=!1;if(i)return;const l=r();o.length<e.length?g(o,e.slice(0,o.length))?u&&l&&l.preventDefault():i=!0:(i=!0,g(o,e)&&(u&&l&&l.preventDefault(),n(l)))},m=o=>{const l=o.at(-1);if(!l)return;const f=r();if(u&&l.length<e.length){d(l,e.slice(0,e.length-1))&&f&&f.preventDefault();return}if(d(l,e)){const y=o.at(-2);(!y||d(y,e.slice(0,e.length-1)))&&(u&&f&&f.preventDefault(),n(f))}};T(L(s,t.requireReset?a:m))}export{M as a,A as c};
