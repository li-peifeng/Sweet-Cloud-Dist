import{cq as F,c4 as I,j as $,l as C,k as j,cp as X,aF as N,dl as Y,aE as J,aG as z,dh as w,o as G,aV as V,W as k}from"./index.d735fbfd.js";import{c as T}from"./index.0f0844ea.js";import{b as Q}from"./Folder.feb9a4b5.js";/*! @viselect/vanilla v3.7.0 MIT | https://github.com/Simonwep/selection/tree/master/packages/vanilla */class U{constructor(){this._listeners=new Map,this.on=this.addEventListener,this.off=this.removeEventListener,this.emit=this.dispatchEvent}addEventListener(e,t){var i;const s=(i=this._listeners.get(e))!=null?i:new Set;return this._listeners.set(e,s),s.add(t),this}removeEventListener(e,t){var s;return(s=this._listeners.get(e))==null||s.delete(t),this}dispatchEvent(e,...t){var i;let s=!0;for(const o of(i=this._listeners.get(e))!=null?i:[])s=o(...t)!==!1&&s;return s}unbindAllListeners(){this._listeners.clear()}}const M=(r,e="px")=>typeof r=="number"?r+e:r,b=({style:r},e,t)=>{if(typeof e=="object")for(const[s,i]of Object.entries(e))i!==void 0&&(r[s]=M(i));else t!==void 0&&(r[e]=M(t))},L=(r=0,e=0,t=0,s=0)=>{const i={x:r,y:e,width:t,height:s,top:e,left:r,right:r+t,bottom:e+s};return{...i,toJSON:()=>JSON.stringify(i)}},Z=r=>{let e,t=-1,s=!1;return{next:(...i)=>{e=i,s||(s=!0,t=requestAnimationFrame(()=>{r(...e),s=!1}))},cancel:()=>{cancelAnimationFrame(t),s=!1}}},O=(r,e,t="touch")=>{switch(t){case"center":{const s=e.left+e.width/2,i=e.top+e.height/2;return s>=r.left&&s<=r.right&&i>=r.top&&i<=r.bottom}case"cover":return e.left>=r.left&&e.top>=r.top&&e.right<=r.right&&e.bottom<=r.bottom;case"touch":return r.right>=e.left&&r.left<=e.right&&r.bottom>=e.top&&r.top<=e.bottom}},ee=()=>matchMedia("(hover: none), (pointer: coarse)").matches,te=()=>"safari"in window,P=r=>(e,t,s,i={})=>{e instanceof HTMLCollection||e instanceof NodeList?e=Array.from(e):Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]);for(const o of e)if(o)for(const n of t)o[r](n,s,{capture:!1,...i});return[e,t,s,i]},y=P("addEventListener"),g=P("removeEventListener"),A=r=>{var o;var e;const{clientX:t,clientY:s,target:i}=(o=(e=r.touches)==null?void 0:e[0])!=null?o:r;return{x:t,y:s,target:i}},E=(r,e=document)=>{const t=Array.isArray(r)?r:[r];let s=[];for(let i=0,o=t.length;i<o;i++){const n=t[i];typeof n=="string"?s=s.concat(Array.from(e.querySelectorAll(n))):n instanceof Element&&s.push(n)}return s},se=(r,e)=>{for(const t of e){if(typeof t=="number")return r.button===t;if(typeof t=="object"){const s=t.button===r.button,i=t.modifiers.every(o=>{switch(o){case"alt":return r.altKey;case"ctrl":return r.ctrlKey||r.metaKey;case"shift":return r.shiftKey}});return s&&i}}return!1},{abs:S,max:B,min:R,ceil:D}=Math,K=(r=[])=>({stored:r,selected:[],touched:[],changed:{added:[],removed:[]}}),H=class extends U{constructor(e){var t,s,i,o,n;super(),this._selection=K(),this._targetBoundaryScrolled=!0,this._selectables=[],this._areaLocation={y1:0,x2:0,y2:0,x1:0},this._areaRect=L(),this._singleClick=!0,this._scrollAvailable=!0,this._scrollingActive=!1,this._scrollSpeed={x:0,y:0},this._scrollDelta={x:0,y:0},this.disable=this._toggleStartEvents.bind(this,!1),this.enable=this._toggleStartEvents,this._options={selectionAreaClass:"selection-area",selectionContainerClass:void 0,selectables:[],document:window.document,startAreas:["html"],boundaries:["html"],container:"body",...e,behaviour:{overlap:"invert",intersect:"touch",triggers:[0],...e.behaviour,startThreshold:(t=e.behaviour)!=null&&t.startThreshold?typeof e.behaviour.startThreshold=="number"?e.behaviour.startThreshold:{x:10,y:10,...e.behaviour.startThreshold}:{x:10,y:10},scrolling:{speedDivider:10,manualSpeed:750,...(s=e.behaviour)==null?void 0:s.scrolling,startScrollMargins:{x:0,y:0,...(o=(i=e.behaviour)==null?void 0:i.scrolling)==null?void 0:o.startScrollMargins}}},features:{range:!0,touch:!0,deselectOnBlur:!1,...e.features,singleTap:{allow:!0,intersect:"native",...(n=e.features)==null?void 0:n.singleTap}}};for(const u of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))typeof this[u]=="function"&&(this[u]=this[u].bind(this));const{document:l,selectionAreaClass:a,selectionContainerClass:_}=this._options;this._area=l.createElement("div"),this._clippingElement=l.createElement("div"),this._clippingElement.appendChild(this._area),this._area.classList.add(a),_&&this._clippingElement.classList.add(_),b(this._area,{willChange:"top, left, bottom, right, width, height",top:0,left:0,position:"fixed"}),b(this._clippingElement,{overflow:"hidden",position:"fixed",transform:"translate3d(0, 0, 0)",pointerEvents:"none",zIndex:"1"}),this._frame=Z(u=>{this._recalculateSelectionAreaRect(),this._updateElementSelection(),this._emitEvent("move",u),this._redrawSelectionArea()}),this.enable()}_toggleStartEvents(e=!0){const{document:t,features:s}=this._options,i=e?y:g;i(t,"mousedown",this._onTapStart),s.touch&&i(t,"touchstart",this._onTapStart,{passive:!1})}_onTapStart(e,t=!1){var x;const{x:s,y:i,target:o}=A(e),{document:n,startAreas:l,boundaries:a,features:_,behaviour:u}=this._options,c=o.getBoundingClientRect();if(e instanceof MouseEvent&&!se(e,u.triggers))return;const m=E(l,n),f=E(a,n);this._targetElement=f.find(v=>O(v.getBoundingClientRect(),c));const p=e.composedPath(),d=m.find(v=>p.includes(v));if(this._targetBoundary=f.find(v=>p.includes(v)),!this._targetElement||!d||!this._targetBoundary||!t&&this._emitEvent("beforestart",e)===!1)return;this._areaLocation={x1:s,y1:i,x2:0,y2:0};const h=(x=n.scrollingElement)!=null?x:n.body;this._scrollDelta={x:h.scrollLeft,y:h.scrollTop},this._singleClick=!0,this.clearSelection(!1,!0),y(n,["touchmove","mousemove"],this._delayedTapMove,{passive:!1}),y(n,["mouseup","touchcancel","touchend"],this._onTapStop),y(n,"scroll",this._onScroll),_.deselectOnBlur&&(this._targetBoundaryScrolled=!1,y(this._targetBoundary,"scroll",this._onStartAreaScroll))}_onSingleTap(e){const{singleTap:{intersect:t},range:s}=this._options.features,i=A(e);let o;if(t==="native")o=i.target;else if(t==="touch"){this.resolveSelectables();const{x:l,y:a}=i;o=this._selectables.find(_=>{const{right:u,left:c,top:m,bottom:f}=_.getBoundingClientRect();return l<u&&l>c&&a<f&&a>m})}if(!o)return;for(this.resolveSelectables();!this._selectables.includes(o);)if(o.parentElement)o=o.parentElement;else{this._targetBoundaryScrolled||this.clearSelection();return}const{stored:n}=this._selection;if(this._emitEvent("start",e),e.shiftKey&&s&&this._latestElement){const l=this._latestElement,[a,_]=l.compareDocumentPosition(o)&4?[o,l]:[l,o],u=[...this._selectables.filter(c=>c.compareDocumentPosition(a)&4&&c.compareDocumentPosition(_)&2),a,_];this.select(u),this._latestElement=l}else n.includes(o)&&(n.length===1||e.ctrlKey||n.every(l=>this._selection.stored.includes(l)))?this.deselect(o):(this.select(o),this._latestElement=o)}_delayedTapMove(e){const{container:t,document:s,behaviour:{startThreshold:i}}=this._options,{x1:o,y1:n}=this._areaLocation,{x:l,y:a}=A(e);if(typeof i=="number"&&S(l+a-(o+n))>=i||typeof i=="object"&&S(l-o)>=i.x||S(a-n)>=i.y){if(g(s,["mousemove","touchmove"],this._delayedTapMove,{passive:!1}),this._emitEvent("beforedrag",e)===!1){g(s,["mouseup","touchcancel","touchend"],this._onTapStop);return}y(s,["mousemove","touchmove"],this._onTapMove,{passive:!1}),b(this._area,"display","block"),E(t,s)[0].appendChild(this._clippingElement),this.resolveSelectables(),this._singleClick=!1,this._targetRect=this._targetElement.getBoundingClientRect(),this._scrollAvailable=this._targetElement.scrollHeight!==this._targetElement.clientHeight||this._targetElement.scrollWidth!==this._targetElement.clientWidth,this._scrollAvailable&&(y(this._targetElement,"wheel",this._manualScroll,{passive:!1}),this._selectables=this._selectables.filter(_=>this._targetElement.contains(_))),this._setupSelectionArea(),this._emitEvent("start",e),this._onTapMove(e)}this._handleMoveEvent(e)}_setupSelectionArea(){const{_clippingElement:e,_targetElement:t,_area:s}=this,i=this._targetRect=t.getBoundingClientRect();this._scrollAvailable?(b(e,{top:i.top,left:i.left,width:i.width,height:i.height}),b(s,{marginTop:-i.top,marginLeft:-i.left})):(b(e,{top:0,left:0,width:"100%",height:"100%"}),b(s,{marginTop:0,marginLeft:0}))}_onTapMove(e){const{_scrollSpeed:t,_areaLocation:s,_options:i,_frame:o}=this,{speedDivider:n}=i.behaviour.scrolling,l=this._targetElement,{x:a,y:_}=A(e);if(s.x2=a,s.y2=_,this._scrollAvailable&&!this._scrollingActive&&(t.y||t.x)){this._scrollingActive=!0;const u=()=>{if(!t.x&&!t.y){this._scrollingActive=!1;return}const{scrollTop:c,scrollLeft:m}=l;t.y&&(l.scrollTop+=D(t.y/n),s.y1-=l.scrollTop-c),t.x&&(l.scrollLeft+=D(t.x/n),s.x1-=l.scrollLeft-m),o.next(e),requestAnimationFrame(u)};requestAnimationFrame(u)}else o.next(e);this._handleMoveEvent(e)}_handleMoveEvent(e){const{features:t}=this._options;(t.touch&&ee()||this._scrollAvailable&&te())&&e.preventDefault()}_onScroll(){var o;const{_scrollDelta:e,_options:{document:t}}=this,{scrollTop:s,scrollLeft:i}=(o=t.scrollingElement)!=null?o:t.body;this._areaLocation.x1+=e.x-i,this._areaLocation.y1+=e.y-s,e.x=i,e.y=s,this._setupSelectionArea(),this._frame.next(null)}_onStartAreaScroll(){this._targetBoundaryScrolled=!0,g(this._targetElement,"scroll",this._onStartAreaScroll)}_manualScroll(e){const{manualSpeed:t}=this._options.behaviour.scrolling,s=e.deltaY?e.deltaY>0?1:-1:0,i=e.deltaX?e.deltaX>0?1:-1:0;this._scrollSpeed.y+=s*t,this._scrollSpeed.x+=i*t,this._onTapMove(e),e.preventDefault()}_recalculateSelectionAreaRect(){const{_scrollSpeed:e,_areaLocation:t,_targetElement:s,_options:i}=this,{scrollTop:o,scrollHeight:n,clientHeight:l,scrollLeft:a,scrollWidth:_,clientWidth:u}=s,c=this._targetRect,{x1:m,y1:f}=t;let{x2:p,y2:d}=t;const{behaviour:{scrolling:{startScrollMargins:h}}}=i;p<c.left+h.x?(e.x=a?-S(c.left-p+h.x):0,p=p<c.left?c.left:p):p>c.right-h.x?(e.x=_-a-u?S(c.left+c.width-p-h.x):0,p=p>c.right?c.right:p):e.x=0,d<c.top+h.y?(e.y=o?-S(c.top-d+h.y):0,d=d<c.top?c.top:d):d>c.bottom-h.y?(e.y=n-o-l?S(c.top+c.height-d-h.y):0,d=d>c.bottom?c.bottom:d):e.y=0;const x=R(m,p),v=R(f,d),W=B(m,p),q=B(f,d);this._areaRect=L(x,v,W-x,q-v)}_redrawSelectionArea(){const{x:e,y:t,width:s,height:i}=this._areaRect,{style:o}=this._area;o.left=`${e}px`,o.top=`${t}px`,o.width=`${s}px`,o.height=`${i}px`}_onTapStop(e,t){var s;const{document:i,features:o}=this._options,{_singleClick:n}=this;g(this._targetElement,"scroll",this._onStartAreaScroll),g(i,["mousemove","touchmove"],this._delayedTapMove),g(i,["touchmove","mousemove"],this._onTapMove),g(i,["mouseup","touchcancel","touchend"],this._onTapStop),g(i,"scroll",this._onScroll),this._keepSelection(),e&&n&&o.singleTap.allow?this._onSingleTap(e):!n&&!t&&(this._updateElementSelection(),this._emitEvent("stop",e)),this._scrollSpeed.x=0,this._scrollSpeed.y=0,g(this._targetElement,"wheel",this._manualScroll,{passive:!0}),this._clippingElement.remove(),(s=this._frame)==null||s.cancel(),b(this._area,"display","none")}_updateElementSelection(){const{_selectables:e,_options:t,_selection:s,_areaRect:i}=this,{stored:o,selected:n,touched:l}=s,{intersect:a,overlap:_}=t.behaviour,u=_==="invert",c=[],m=[],f=[];for(let d=0;d<e.length;d++){const h=e[d];if(O(i,h.getBoundingClientRect(),a)){if(n.includes(h))o.includes(h)&&!l.includes(h)&&l.push(h);else if(u&&o.includes(h)){f.push(h);continue}else m.push(h);c.push(h)}}u&&m.push(...o.filter(d=>!n.includes(d)));const p=_==="keep";for(let d=0;d<n.length;d++){const h=n[d];!c.includes(h)&&!(p&&o.includes(h))&&f.push(h)}s.selected=c,s.changed={added:m,removed:f},this._latestElement=void 0}_emitEvent(e,t){return this.emit(e,{event:t,store:this._selection,selection:this})}_keepSelection(){const{_options:e,_selection:t}=this,{selected:s,changed:i,touched:o,stored:n}=t,l=s.filter(a=>!n.includes(a));switch(e.behaviour.overlap){case"drop":{t.stored=[...l,...n.filter(a=>!o.includes(a))];break}case"invert":{t.stored=[...l,...n.filter(a=>!i.removed.includes(a))];break}case"keep":{t.stored=[...n,...s.filter(a=>!n.includes(a))];break}}}trigger(e,t=!0){this._onTapStart(e,t)}resolveSelectables(){this._selectables=E(this._options.selectables,this._options.document)}clearSelection(e=!0,t=!1){const{selected:s,stored:i,changed:o}=this._selection;o.added=[],o.removed.push(...s,...e?i:[]),t||(this._emitEvent("move",null),this._emitEvent("stop",null)),this._selection=K(e?[]:i)}getSelection(){return this._selection.stored}getSelectionArea(){return this._area}cancel(e=!1){this._onTapStop(null,!e)}destroy(){this.cancel(),this.disable(),this._clippingElement.remove(),super.unbindAllListeners()}select(e,t=!1){const{changed:s,selected:i,stored:o}=this._selection,n=E(e,this._options.document).filter(l=>!i.includes(l)&&!o.includes(l));return o.push(...n),i.push(...n),s.added.push(...n),s.removed=[],this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null)),n}deselect(e,t=!1){const{selected:s,stored:i,changed:o}=this._selection,n=E(e,this._options.document).filter(l=>s.includes(l)||i.includes(l));n.length&&(this._selection.stored=i.filter(l=>!n.includes(l)),this._selection.selected=s.filter(l=>!n.includes(l)),this._selection.changed.added=[],this._selection.changed.removed.push(...n.filter(l=>!o.removed.includes(l))),this._latestElement=void 0,t||(this._emitEvent("move",null),this._emitEvent("stop",null)))}};H.version="3.7.0";let ie=H;function ae(){const[r,e]=$(C.open_item_on_checkbox==="direct"),t=T("Alt",{preventDefault:!1}),s=T("Meta",{preventDefault:!1}),i=T("Control",{preventDefault:!1});return j(()=>{switch(C.open_item_on_checkbox){case"direct":{e(!0);break}case"disable_while_checked":{e(!N());break}case"with_ctrl":{e(X?s():i());break}case"with_alt":e(t())}}),r}function ce(){const r=()=>C.select_with_mouse==="disabled",e=()=>!Y&&!r()&&!J(),t=()=>{j(()=>{if(!e())return;const o=new ie({selectionAreaClass:"viselect-selection-area",startAreas:[".viselect-container"],boundaries:[".viselect-container"],selectables:[".viselect-item"]});o.on("start",({event:n})=>{const l=n;o.clearSelection(!0,!0),o.select(".viselect-item.selected",!0),!l.ctrlKey&&!l.metaKey&&(z(!1),o.clearSelection())}),o.on("move",({store:{changed:{added:n,removed:l}}})=>{for(const a of n)w(Number(a.getAttribute("data-index")),!0);for(const a of l)w(Number(a.getAttribute("data-index")),!1)}),G(()=>o.destroy())})},{show:s}=Q({id:1});return{isMouseSupported:e,registerSelectContainer:t,captureContentMenu:o=>{if(o.preventDefault(),N()&&!V()){const l=o.target.closest(".viselect-item"),a=Number(l==null?void 0:l.getAttribute("data-index"));if(Number.isNaN(a)||!(()=>!!k.objs[a].selected)())return;o.stopPropagation(),s(o,{props:k.obj})}}}}const he=F(I,{baseStyle:{_before:{content:"",pos:"absolute",top:-10,right:-2,bottom:-10,left:-10}}});export{he as I,ce as a,ae as u};
