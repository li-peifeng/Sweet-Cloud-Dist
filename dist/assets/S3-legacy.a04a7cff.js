System.register(["./index-legacy.479435ca.js","./useTitle-legacy.43c4fcd1.js","./index-legacy.ae5307c5.js","./SettingItem-legacy.0bdf6c0a.js","./ResponsiveGrid-legacy.3759bdd2.js","./FolderTree-legacy.45ccd58d.js","./index-legacy.dc3c8bad.js","./index-legacy.05b1e73f.js","./LinkWithBase-legacy.32d9c645.js","./index-legacy.4c2a0b44.js","./item_type-legacy.d1f1c701.js","./_commonjs-dynamic-modules-legacy.cf19cda3.js"],(function(e,t){"use strict";var n,r,s,c,a,l,i,g,o,u,d,y,h,m,f,b,k,p,_,v,x,j,S,w,$,C,I;return{setters:[e=>{n=e.d,r=e.c,s=e.br,c=e.be,a=e.t,l=e.cM,i=e.B,g=e.z,o=e.y,u=e.Z,d=e.aP,y=e.b2,h=e.c4,m=e.cJ,f=e.j,b=e.cK,k=e.S,p=e.b3,_=e.n,v=e.bG,x=e.al},e=>{j=e.g},e=>{S=e.G},e=>{w=e.I},e=>{$=e.R},e=>{C=e.a},e=>{I=e.c},()=>{},()=>{},()=>{},()=>{},()=>{}],execute:function(){const t=e=>{const t=n();return r(l,{w:"$full",overflowX:"auto",shadow:"$md",rounded:"$lg",p:"$2",direction:{"@initial":"column","@xl":"row"},spacing:"$2",get children(){return[r(s,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[r(c,{for:"path",display:"flex",alignItems:"center",get children(){return t("global.name")}}),r(a,{id:"name",get value(){return e.name},onChange:t=>e.onChange({...e,name:t.currentTarget.value})})]}}),r(s,{w:"$full",display:"flex",flexDirection:"column",required:!0,get children(){return[r(c,{for:"path",display:"flex",alignItems:"center",get children(){return t("metas.path")}}),r(C,{id:"path",get value(){return e.path},onChange:t=>e.onChange({...e,path:t})})]}}),r(l,{direction:{"@initial":"row","@xl":"column"},justifyContent:{"@xl":"center"},spacing:"$1",get children(){return r(i,{colorScheme:"danger",onClick:async()=>{e.onDelete()},get children(){return t("global.delete")}})}})]}})},D=e=>{const s=n();return console.log(e.buckets),r(u,{alignItems:"start",w:"$full",get children(){return[r(c,{display:"flex",alignItems:"center",get children(){return s("settings.s3_buckets")}}),r(i,{onClick:()=>{e.setSettings((e=>"s3_buckets"===e.key),"value",JSON.stringify([...e.buckets,{name:"",path:""}])),console.log(e.buckets)},get children(){return s("global.add")}}),r(g,{get each(){return e.buckets},children:n=>r(t,o(n,{onChange:t=>{console.log(t),e.setSettings((e=>"s3_buckets"===e.key),"value",JSON.stringify(e.buckets.map((e=>e.name===n.name?t:e))))},onDelete:()=>{e.setSettings((e=>"s3_buckets"===e.key),"value",JSON.stringify(e.buckets.filter((e=>e.name!==n.name))))}}))})]}})},J=e=>{const t={...e.find((e=>"s3_buckets"===e.key))};return t.value?JSON.parse(t.value):[]};e("default",(()=>{const e=n();j("manage.sidemenu.s3");const[t,s]=d((()=>y.get(`/admin/setting/list?group=${S.S3}`))),[c,a]=h([]),l=async()=>{const e=await s();p(e,a)};l();const[g,C]=d((()=>y.post("/admin/setting/save",m(c)))),[B,N]=f(!1);return r(u,{w:"$full",alignItems:"start",spacing:"$2",get children(){return[r($,{get children(){return[r(b,{each:c,children:(t,n)=>r(k,{get when(){return"s3_buckets"!=t().key},get children(){return r(w,o(t,{onChange:e=>{a((e=>t().key===e.key),"value",e)},onDelete:async()=>{N(!0);const n=await y.post(`/admin/setting/delete?key=${t().key}`);N(!1),p(n,(()=>{_.success(e("global.delete_success")),l()}))}}))}})}),r(i,{onClick:()=>{const e=I.lib.WordArray.random(15),t=I.lib.WordArray.random(30),n=I.enc.Base64.stringify(e).replace(/[\r\n]/g,""),r=I.enc.Base64.stringify(t).replace(/[\r\n]/g,"");a((e=>"s3_access_key_id"===e.key),"value",n),a((e=>"s3_secret_access_key"===e.key),"value",r)},get children(){return e("settings.s3_generate")}}),r(v,{get children(){return e("settings.s3_restart_to_apply")}}),r(D,{get buckets(){return J(c)},setSettings:a})]}}),r(x,{spacing:"$2",get children(){return[r(i,{colorScheme:"accent",onClick:l,get loading(){return t()||B()},get children(){return e("global.refresh")}}),r(i,{get loading(){return g()},onClick:async()=>{const t=J(c),n=new Set;for(const s of t){if(""===s.name||""===s.path)return void _.error(e("settings.s3_buckets_empty"));if(n.has(s.name))return void _.error(e("settings.s3_buckets_duplicate_name"));n.add(s.name)}const r=await C();p(r,(()=>_.success(e("global.save_success"))))},get children(){return e("global.save")}})]}})]}})}))}}}));
